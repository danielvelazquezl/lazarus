<p id="notice"><%= notice %></p>


<div class="content-heading">
  <div> Ordenes de Componentes</div>

  <div class="ml-auto">
    <%= link_to new_component_proof_orders_path do %>
      <button class="btn btn-secondary">
        <i class="fas fa-plus text-primary fa-1x"></i>
      </button>
    <% end %>
  </div>
</div>

<table class="table table-striped table-hover w-100" id="datatable2">
  <thead>
  <tr>
    <th>
      <strong>N°</strong>
    </th>
    <th>
      <strong>ENCARGADO</strong>
    </th>
    <th>
      <strong>DEPOSITO ORIGEN</strong>
    </th>

    <th>
      <strong>DEPOSITO DESTINO</strong>
    </th>
    <th>
      <strong>FECHA PEDIDO</strong>
    </th>
    <th>
      <strong>FECHA FINALIZADO</strong>
    </th>
    <th>
      <strong>ESTADO</strong>
    </th>
    <th>
      <strong>ACCION</strong>
    </th>
  </tr>
  </thead>
  <tbody>
  <% @orders.each do |order| %>
    <tr>
      <td><%= order.number %></td>
      <td><%= order.person.name %></td>
      <td><%= order.origin.description %></td>
      <td><%= order.destination.description %></td>
      <td><%= order.date_request.strftime("%d-%m-%Y %H:%M") %></td>
      <% if order.date_finished == nil then %>
        <td></td>
      <% else %>
        <td><%= order.date_finished.strftime("%d-%m-%Y %H:%M") %></td>
      <% end %>
      <td>
        <%= form_for order do |f| %>
          <% if order.state.finished? || order.state.canceled? %>
            <%= f.select :state, Order.state.options, {}, {disabled: true, value: order.state, onchange: 'this.form.submit ();'} %>
          <% else %>
            <%= f.select :state, Order.state.options, {}, {value: order.state, onchange: 'this.form.submit ();'} %>
          <% end %>

        <% end %>
      </td>
      <td>
        <div class="btn-group" role="group">
          <%= link_to order do %>
            <button class="btn btn-sm btn-secondary"><i class="fas fa-eye"></i></button>
          <% end %>
          <% if order.state.finished? || order.state.canceled? %>
            <button class="btn btn-sm btn-secondary" disabled><i class="fas fa-edit"></i></button>
          <% else %>
            <%= link_to edit_order_path(order) do %>
              <button class="btn btn-sm btn-secondary"><i class="fas fa-edit"></i></button>
            <% end %>
          <% end %>
          <%= link_to order, method: :delete, data: {confirm: 'Estás seguro?'},
                      :remote => true, :class => 'delete_order' do %>
            <button class="btn btn-sm btn-secondary"><i class="fas fa-trash-alt"></i></button>
          <% end %>
        </div>
      </td>
    </tr>
  <% end %>
  </tbody>
</table>
